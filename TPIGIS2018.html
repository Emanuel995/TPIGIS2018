<!doctype html>
<html lang="en">
<head>
    <!-- archivo CSS con los estilos propios de OpenLayers (href con ruta relativa) -->
    <link rel="stylesheet" href="ol4/css/ol.css" type="text/css">

    <style>
        /* selector CSS #map: selecciona cualquier elemento con id="map" */
        #map {
            height: 400px;	/* alto del elemento = 400px */
            width: 100%;	/* ancho del elemento = 100% de su elemento contenedor */
            border: 1px solid; /* borde 1px */
        }
    </style>
    <!-- Titulo de la paginan -->
    <title>Trabajo Practico Integrador GIS 2018</title>
    <!-- tag script que incluye el archivo .js que contiene la libreria -->
    <script src="ol4/build/ol.js" type="text/javascript"></script>
    <!-- script con la url del servicio WMS-->
    <script src="url.js" type="text/javascript"></script>
    <!-- script la libreria JQuery-->
    <script src="jquery.min.js" type="text/javascript"></script>
    <script>
    //Nombre y Titulos de las CAPAS
    var NombreCapas = [
        "puente_red_vial_puntos","puntos_de_alturas_topograficas","puntos_del_terreno","salvado_de_obstaculo",
        "senalizaciones","otras_edificaciones","estructuras_portuarias","infraestructura_aeroportuaria_punto","infraestructura_hidro",
        "actividades_agropecuarias","actividades_economicas","complejo_de_energia_ene","edif_construcciones_turisticas","edif_depor_y_esparcimiento",
        "edif_educacion","edif_religiosos","edificio_de_salud_ips","edificio_publico_ips","edificios_ferroviarios","localidades",
        "marcas_y_senales","obra_de_comunicacion","obra_portuaria","red_ferroviaria","red_vial","vias_secundarias","curso_de_agua_hid",
        "curvas_de_nivel","lineas_de_conduccion_ene","muro_embalse","limite_politico_administrativo_lim","espejo_de_agua_hid",
        "ejido","isla","sue_congelado","sue_consolidado","sue_costero","sue_hidromorfologico","sue_no_consolidado","veg_arborea",
        "veg_arbustiva","veg_cultivos","veg_hidrofila","veg_suelo_desnudo"
    ]
    var TituloCapas = [
        "Puente Red Vial","Alturas Topograficas","Puntos Del Terreno","Salvado De Obstaculo","Senalizaciones",
        "Otras Edificaciones","Estructuras Portuarias","Infraestructura Aeroportuaria","Infraestructura Hidrologica","Actividades Agropecuarias",
        "Actividades Economicas","Complejo De Energia","Edificios Contrucciones y Turisticas","Edificios Deporivos y Esparcimiento",
        "Edificios Educativos","Edificios Religiosos","Edificios de Salud","Edificios Publicos","Edificios Ferroviarios",
        "Localidades","Marcas y senales","Obra de Comunicacion","Obra Portuaria","Red Ferroviaria","Red Vial","Vias Secundarias",
        "Curso de agua","Curvas de nivel","Lineas de conduccion","Muro de embalse","Limite politico administrativo","Espejo de agua",
        "Ejido","Isla","Suelo congelado","Suelo consolidado","Suelo costero","Suelo hidromorfologico","Suelo no consolidado",
        "Vegetacion arborea","Vegetacion arbustiva","Vegetacion de cultivos","Vegetacion hidrofila","Vegetacion de suelo desnudo"
    ]
    </script>
    
</head>

<body>
    <!--Imagen Soy el MAPA y TITULO-->
    <h1><img src="imagenes/soyelmapa.jpeg" width="75" height="75">
        Trabajo Practico Integrador GIS 2018 </h1>
    
    <!-- DIV que contiene el mapa -->
    <div id="map"></div>
    <div id="panel">
            <h3><img src="imagenes/capas.jpg" width="75" height="75">Capas</h3>
            <script>
                //Cargamos la capas
                for (i = 0; i < TituloCapas.length; i++){ 
                    var layer = ""                           
                    Titulo = TituloCapas[i];
                    layer = "check_layer_"+(i+1);
                    text = "<input type=checkbox id="+layer+"><label for="+layer+">"+Titulo+"</label><br/>";
                    document.write(layer,text)
                }
            </script>
            
            <!-- Radio buttons para cambiar las interacciones activas -->
            <h3><img src="imagenes/controles.jpg" width="75" height="75">
                Controles</h3>
            <!-- evento onchange: ejecuta la funcion seleccionarControl -->
            <input
                type="radio"
                name="controles"
                id="controles_navegacion"
                value="navegacion"
                checked="checked"
                onchange="seleccionarControl(this)"

            > <label for="controles_navegacion"> Navegacion</label><br/>
        <input
            type="radio"
            name="controles"
            id="controles_consulta"
            value="consulta"
            onchange="seleccionarControl(this)"
            > <label for="controles_consulta"> Consulta</label><br/>

        </div>

    <!-- SCRIPT que crea el mapa y sus capas -->
    <script type="text/javascript">
        // defino las variables de las capas para usarlas luego

        var puente_red_vial_puntos= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
                title: "puente_red_vial_puntos",
                visible: false,
                source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                    url: URL_OGC,
                    params: {LAYERS: 'puente_red_vial_puntos'}//por defecto version WMS = 1.3.0
                    })
                })
        var puntos_de_alturas_topograficas= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
                title: "puntos_de_alturas_topograficas",
                visible: false,
                source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                    url: URL_OGC,
                    params: {LAYERS: 'puntos_de_alturas_topograficas'}//por defecto version WMS = 1.3.0
                    })
                })
        var puntos_del_terreno= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "puntos_del_terreno",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'puntos_del_terreno'}//por defecto version WMS = 1.3.0
                })
            })
        var salvado_de_obstaculo= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "salvado_de_obstaculo",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'salvado_de_obstaculo'}//por defecto version WMS = 1.3.0
                })
            })
        var senalizaciones= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "senalizaciones",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'senalizaciones'}//por defecto version WMS = 1.3.0
            })
        }) 
        var otras_edificaciones= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "otras_edificaciones",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'otras_edificaciones'}//por defecto version WMS = 1.3.0
            })
        })
        var estructuras_portuarias= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "estructuras_portuarias",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'estructuras_portuarias'}//por defecto version WMS = 1.3.0
            })
        })
        var infraestructura_aeroportuaria_punto= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "infraestructura_aeroportuaria_punto",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'infraestructura_aeroportuaria_punto'}//por defecto version WMS = 1.3.0
            })
        })
        var infraestructura_hidro= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "infraestructura_hidro",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'infraestructura_hidro'}//por defecto version WMS = 1.3.0
            })
        })
        var actividades_agropecuarias= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "actividades_agropecuarias",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'actividades_agropecuarias'}//por defecto version WMS = 1.3.0
            })
        })
        var actividades_economicas= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "actividades_economicas",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'actividades_economicas'}//por defecto version WMS = 1.3.0
            })
        })
        var complejo_de_energia_ene= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "complejo_de_energia_ene",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'complejo_de_energia_ene'}//por defecto version WMS = 1.3.0
            })
        })
        var edif_construcciones_turisticas= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edif_construcciones_turisticas",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edif_construcciones_turisticas'}//por defecto version WMS = 1.3.0
            })
        })
        var edif_depor_y_esparcimiento= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edif_depor_y_esparcimiento",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edif_depor_y_esparcimiento'}//por defecto version WMS = 1.3.0
            })
        })
        var edif_educacion= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edif_educacion",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edif_educacion'}//por defecto version WMS = 1.3.0
            })
        })
        var edif_religiosos= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edif_religiosos",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edif_religiosos'}//por defecto version WMS = 1.3.0
            })
        })
        var edificio_de_salud_ips= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edificio_de_salud_ips",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edificio_de_salud_ips'}//por defecto version WMS = 1.3.0
            })
        })
        var edificio_publico_ips= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edificio_publico_ips",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edificio_publico_ips'}//por defecto version WMS = 1.3.0
            })
        })
        var edificios_ferroviarios= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "edificios_ferroviarios",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'edificios_ferroviarios'}//por defecto version WMS = 1.3.0
            })
        })
        var localidades= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "localidades",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'localidades'}//por defecto version WMS = 1.3.0
            })
        })
        var marcas_y_senales= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "marcas_y_senales",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'marcas_y_senales'}//por defecto version WMS = 1.3.0
            })
        }) 
        var obra_de_comunicacion= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "obra_de_comunicacion",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'obra_de_comunicacion'}//por defecto version WMS = 1.3.0
            })
        })
        var obra_portuaria= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "obra_portuaria",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'obra_portuaria'}//por defecto version WMS = 1.3.0
            })
        })
        var red_ferroviaria= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "red_ferroviaria",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'red_ferroviaria'}//por defecto version WMS = 1.3.0
            })
        })
        var vias_secundarias= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "vias_secundarias",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'vias_secundarias'}//por defecto version WMS = 1.3.0
            })
        })
        var curvas_de_nivel= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "curvas_de_nivel",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'curvas_de_nivel'}//por defecto version WMS = 1.3.0
            })
        })
        var lineas_de_conduccion_ene= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "lineas_de_conduccion_ene",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'lineas_de_conduccion_ene'}//por defecto version WMS = 1.3.0
            })
        })
        var muro_embalse= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "muro_embalse",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'muro_embalse'}//por defecto version WMS = 1.3.0
            })
        })
        var limite_politico_administrativo_lim= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "limite_politico_administrativo_lim",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'limite_politico_administrativo_lim'}//por defecto version WMS = 1.3.0
            })
        })
        var curso_de_agua_hid= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "curso_de_agua_hid",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'curso_de_agua_hid'}//por defecto version WMS = 1.3.0
            })
        })
        var ejido= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "ejido",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'ejido'}//por defecto version WMS = 1.3.0
            })
        })
        var isla= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "isla",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'isla'}//por defecto version WMS = 1.3.0
            })
        })
        var sue_congelado= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "sue_congelado",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'sue_congelado'}//por defecto version WMS = 1.3.0
            })
        })
        var sue_consolidado= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "sue_consolidado",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'sue_consolidado'}//por defecto version WMS = 1.3.0
            })
        })
        var sue_costero= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "sue_costero",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'sue_costero'}//por defecto version WMS = 1.3.0
            })
        })
        var sue_hidromorfologico= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "sue_hidromorfologico",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'sue_hidromorfologico'}//por defecto version WMS = 1.3.0
            })
        })
        var sue_no_consolidado= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "sue_no_consolidado",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'sue_no_consolidado'}//por defecto version WMS = 1.3.0
            })
        })
        var veg_arbustiva= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "veg_arbustiva",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'veg_arbustiva'}//por defecto version WMS = 1.3.0
            })
        })
        var veg_suelo_desnudo= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "veg_suelo_desnudo",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'veg_suelo_desnudo'}//por defecto version WMS = 1.3.0
            })
        })
        
        var espejo_de_agua= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
                title: "espejo_de_agua_hid",
                visible: false,
                source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                    url: URL_OGC,
                    params: {LAYERS: 'espejo_de_agua_hid'}//por defecto version WMS = 1.3.0
                    })
                })
        var red_vial= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "red_vial",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'red_vial'}//por defecto version WMS = 1.3.0
                    })
                }) 
        var veg_cultivos= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "veg_cultivos",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'veg_cultivos'}//por defecto version WMS = 1.3.0
                    })
                })                 
        var veg_arborea= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "veg_arborea",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'veg_arborea'}//por defecto version WMS = 1.3.0
                    })
                })  
        var veg_hidrofila= new ol.layer.Image({//objeto capa de tipo Imagen (1 sola imagen)
            title: "veg_hidrofila",
            visible: false,
            source: new ol.source.ImageWMS({//fuente de datos (ImageWMS)
                url: URL_OGC,
                params: {LAYERS: 'veg_hidrofila'}//por defecto version WMS = 1.3.0
                    })
                })   
        

        // definicion del mapa y su capa

        var map = new ol.Map({
            target: 'map',                
            layers: [
                new ol.layer.Tile({
                    title: "Natural Earth Base Map",
                    source: new ol.source.TileWMS({
                        url: URL_OGC,
                        params: {//parametros del servicio WMS
                            LAYERS: 'pais_lim', //capa(s) del servicio WMS
                            VERSION: '1.1.1' //version del estandar WMS
                        }
                    })
                }),
                    puente_red_vial_puntos,
                    puntos_de_alturas_topograficas,
                    puntos_del_terreno,
                    salvado_de_obstaculo,
                    senalizaciones,
                    otras_edificaciones,
                    estructuras_portuarias,
                    infraestructura_aeroportuaria_punto,
                    infraestructura_hidro,
                    actividades_agropecuarias,
                    actividades_economicas,
                    complejo_de_energia_ene,
                    edif_construcciones_turisticas,
                    edif_depor_y_esparcimiento,
                    edif_educacion,
                    edif_religiosos,
                    edificio_de_salud_ips,
                    edificio_publico_ips,
                    edificios_ferroviarios,
                    localidades,
                    marcas_y_senales,
                    obra_de_comunicacion,
                    obra_portuaria,
                    red_ferroviaria,
                    red_vial,
                    vias_secundarias,
                    curso_de_agua_hid,
                    curvas_de_nivel,
                    lineas_de_conduccion_ene,
                    muro_embalse,
                    limite_politico_administrativo_lim,
                    espejo_de_agua,
                    ejido,
                    isla,
                    sue_congelado,
                    sue_consolidado,
                    sue_costero,
                    sue_hidromorfologico,
                    sue_no_consolidado,
                    veg_arborea,
                    veg_arbustiva,
                    veg_cultivos,
                    veg_hidrofila,
                    veg_suelo_desnudo
            ],
            view: new ol.View({
                projection: 'EPSG:4326',
                center: [-60, -26.5],
                zoom: 7
             })
         });
        
         //function que va a realizar la peticion de la consulta
        var consultar = function(coordinate){
            console.log(coordinate);
            if(coordinate.length==2){
                //es un punto [lon,lat]
                var wkt='POINT('+coordinate[0]+' ' +coordinate[1]+')';
            }else{
                //es un poligono en la forma [ [ [lon,lat],[lon,lat],....] ]
                var wkt = 'POLYGON((';
                for(var i=0;i<coordinate[0].length - 1;i++){
                    wkt+=coordinate[0][i][0]+ ' ' + coordinate[0][i][1]+ ',';
                }
                wkt+=coordinate[0][0][0]+' '+coordinate[0][0][1]+'))'
            }
            console.log(wkt);
            window.open('consulta.php?wkt='+wkt);return;
                // jQuery.ajax({
                //     url:'consulta.php',
                //     method: 'GET',
                //     data:{
                //         wkt:wkt
                //     },
                //     success:function(data){
                //         console.log(data);
                //     }
                // });
        };
        //Interaccion para crear un dragbox
        var selectInteraction = new ol.interaction.DragBox(
                {
                //condicion mediante la cual se activa la interaccion
                condition: ol.events.condition.always, 
                //estilo del rectangulo a dibujar (el dragbox)
                style: new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: [255, 0, 0, 1]
                    })
                })
                }
        );
        selectInteraction.on('boxend', function (evt) {
            //mando por consola las coordenadas de la geometria creada
            console.log('boxend', selectInteraction.getGeometry().getCoordinates());
            //consulta en funcion de las coordenadas del dragbox
            consultar(selectInteraction.getGeometry().getCoordinates());
        });
        //funcion para el evento click en el mapa
        var clickEnMapa = function (evt) {
            //muestro por consola las coordenadas del evento
            console.log('click',evt.coordinate);
            //consulta en funcion de un punto
            consultar(evt.coordinate);
        };
        //function para "cambiar" de interaction en function del value de los radios
        var seleccionarControl = function (el) {
            if (el.value == "consulta") {
                //agrego la interaccion del dragbox
                //la cual tiene precedencia sobre las otras
                map.addInteraction(selectInteraction);
                //subscribo una funcion al evento click del mapa
                map.on('click', clickEnMapa);
            } else if (el.value == "navegacion") {
                //la remuevo...
                map.removeInteraction(selectInteraction);
                map.un('click', clickEnMapa);
            }
            //muestro por consola el valor
            console.log(el.value);
        };
        //visibilidad de las capas
        var checkbox1 = document.getElementById('check_layer_1');
checkbox1.addEventListener('change',function() {
var checked = this.checked;
if (checked !== puente_red_vial_puntos.getVisible()){
puente_red_vial_puntos.setVisible(checked);
}
});
puente_red_vial_puntos.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox1.checked){
checkbox1.checked = visible;
}
});
var checkbox2 = document.getElementById('check_layer_2');
checkbox2.addEventListener('change',function() {
var checked = this.checked;
if (checked !== puntos_de_alturas_topograficas.getVisible()){
puntos_de_alturas_topograficas.setVisible(checked);
}
});
puntos_de_alturas_topograficas.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox2.checked){
checkbox2.checked = visible;
}
});
var checkbox3 = document.getElementById('check_layer_3');
checkbox3.addEventListener('change',function() {
var checked = this.checked;
if (checked !== puntos_del_terreno.getVisible()){
puntos_del_terreno.setVisible(checked);
}
});
puntos_del_terreno.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox3.checked){
checkbox3.checked = visible;
}
});
var checkbox4 = document.getElementById('check_layer_4');
checkbox4.addEventListener('change',function() {
var checked = this.checked;
if (checked !== salvado_de_obstaculo.getVisible()){
salvado_de_obstaculo.setVisible(checked);
}
});
salvado_de_obstaculo.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox4.checked){
checkbox4.checked = visible;
}
});
var checkbox5 = document.getElementById('check_layer_5');
checkbox5.addEventListener('change',function() {
var checked = this.checked;
if (checked !== senalizaciones.getVisible()){
senalizaciones.setVisible(checked);
}
});
senalizaciones.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox5.checked){
checkbox5.checked = visible;
}
});
var checkbox6 = document.getElementById('check_layer_6');
checkbox6.addEventListener('change',function() {
var checked = this.checked;
if (checked !== otras_edificaciones.getVisible()){
otras_edificaciones.setVisible(checked);
}
});
otras_edificaciones.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox6.checked){
checkbox6.checked = visible;
}
});
var checkbox7 = document.getElementById('check_layer_7');
checkbox7.addEventListener('change',function() {
var checked = this.checked;
if (checked !== estructuras_portuarias.getVisible()){
estructuras_portuarias.setVisible(checked);
}
});
estructuras_portuarias.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox7.checked){
checkbox7.checked = visible;
}
});
var checkbox8 = document.getElementById('check_layer_8');
checkbox8.addEventListener('change',function() {
var checked = this.checked;
if (checked !== infraestructura_aeroportuaria_punto.getVisible()){
infraestructura_aeroportuaria_punto.setVisible(checked);
}
});
infraestructura_aeroportuaria_punto.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox8.checked){
checkbox8.checked = visible;
}
});
var checkbox9 = document.getElementById('check_layer_9');
checkbox9.addEventListener('change',function() {
var checked = this.checked;
if (checked !== infraestructura_hidro.getVisible()){
infraestructura_hidro.setVisible(checked);
}
});
infraestructura_hidro.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox9.checked){
checkbox9.checked = visible;
}
});
var checkbox10 = document.getElementById('check_layer_10');
checkbox10.addEventListener('change',function() {
var checked = this.checked;
if (checked !== actividades_agropecuarias.getVisible()){
actividades_agropecuarias.setVisible(checked);
}
});
actividades_agropecuarias.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox10.checked){
checkbox10.checked = visible;
}
});
var checkbox11 = document.getElementById('check_layer_11');
checkbox11.addEventListener('change',function() {
var checked = this.checked;
if (checked !== actividades_economicas.getVisible()){
actividades_economicas.setVisible(checked);
}
});
actividades_economicas.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox11.checked){
checkbox11.checked = visible;
}
});
var checkbox12 = document.getElementById('check_layer_12');
checkbox12.addEventListener('change',function() {
var checked = this.checked;
if (checked !== complejo_de_energia_ene.getVisible()){
complejo_de_energia_ene.setVisible(checked);
}
});
complejo_de_energia_ene.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox12.checked){
checkbox12.checked = visible;
}
});
var checkbox13 = document.getElementById('check_layer_13');
checkbox13.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edif_construcciones_turisticas.getVisible()){
edif_construcciones_turisticas.setVisible(checked);
}
});
edif_construcciones_turisticas.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox13.checked){
checkbox13.checked = visible;
}
});
var checkbox14 = document.getElementById('check_layer_14');
checkbox14.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edif_depor_y_esparcimiento.getVisible()){
edif_depor_y_esparcimiento.setVisible(checked);
}
});
edif_depor_y_esparcimiento.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox14.checked){
checkbox14.checked = visible;
}
});
var checkbox15 = document.getElementById('check_layer_15');
checkbox15.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edif_educacion.getVisible()){
edif_educacion.setVisible(checked);
}
});
edif_educacion.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox15.checked){
checkbox15.checked = visible;
}
});
var checkbox16 = document.getElementById('check_layer_16');
checkbox16.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edif_religiosos.getVisible()){
edif_religiosos.setVisible(checked);
}
});
edif_religiosos.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox16.checked){
checkbox16.checked = visible;
}
});
var checkbox17 = document.getElementById('check_layer_17');
checkbox17.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edificio_de_salud_ips.getVisible()){
edificio_de_salud_ips.setVisible(checked);
}
});
edificio_de_salud_ips.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox17.checked){
checkbox17.checked = visible;
}
});
var checkbox18 = document.getElementById('check_layer_18');
checkbox18.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edificio_publico_ips.getVisible()){
edificio_publico_ips.setVisible(checked);
}
});
edificio_publico_ips.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox18.checked){
checkbox18.checked = visible;
}
});
var checkbox19 = document.getElementById('check_layer_19');
checkbox19.addEventListener('change',function() {
var checked = this.checked;
if (checked !== edificios_ferroviarios.getVisible()){
edificios_ferroviarios.setVisible(checked);
}
});
edificios_ferroviarios.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox19.checked){
checkbox19.checked = visible;
}
});
var checkbox20 = document.getElementById('check_layer_20');
checkbox20.addEventListener('change',function() {
var checked = this.checked;
if (checked !== localidades.getVisible()){
localidades.setVisible(checked);
}
});
localidades.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox20.checked){
checkbox20.checked = visible;
}
});
var checkbox21 = document.getElementById('check_layer_21');
checkbox21.addEventListener('change',function() {
var checked = this.checked;
if (checked !== marcas_y_senales.getVisible()){
marcas_y_senales.setVisible(checked);
}
});
marcas_y_senales.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox21.checked){
checkbox21.checked = visible;
}
});
var checkbox22 = document.getElementById('check_layer_22');
checkbox22.addEventListener('change',function() {
var checked = this.checked;
if (checked !== obra_de_comunicacion.getVisible()){
obra_de_comunicacion.setVisible(checked);
}
});
obra_de_comunicacion.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox22.checked){
checkbox22.checked = visible;
}
});
var checkbox23 = document.getElementById('check_layer_23');
checkbox23.addEventListener('change',function() {
var checked = this.checked;
if (checked !== obra_portuaria.getVisible()){
obra_portuaria.setVisible(checked);
}
});
obra_portuaria.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox23.checked){
checkbox23.checked = visible;
}
});
var checkbox24 = document.getElementById('check_layer_24');
checkbox24.addEventListener('change',function() {
var checked = this.checked;
if (checked !== red_ferroviaria.getVisible()){
red_ferroviaria.setVisible(checked);
}
});
red_ferroviaria.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox24.checked){
checkbox24.checked = visible;
}
});
var checkbox25 = document.getElementById('check_layer_25');
checkbox25.addEventListener('change',function() {
var checked = this.checked;
if (checked !== red_vial.getVisible()){
red_vial.setVisible(checked);
}
});
red_vial.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox25.checked){
checkbox25.checked = visible;
}
});
var checkbox26 = document.getElementById('check_layer_26');
checkbox26.addEventListener('change',function() {
var checked = this.checked;
if (checked !== vias_secundarias.getVisible()){
vias_secundarias.setVisible(checked);
}
});
vias_secundarias.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox26.checked){
checkbox26.checked = visible;
}
});
var checkbox27 = document.getElementById('check_layer_27');
checkbox27.addEventListener('change',function() {
var checked = this.checked;
if (checked !== curso_de_agua_hid.getVisible()){
curso_de_agua_hid.setVisible(checked);
}
});
curso_de_agua_hid.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox27.checked){
checkbox27.checked = visible;
}
});
var checkbox28 = document.getElementById('check_layer_28');
checkbox28.addEventListener('change',function() {
var checked = this.checked;
if (checked !== curvas_de_nivel.getVisible()){
curvas_de_nivel.setVisible(checked);
}
});
curvas_de_nivel.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox28.checked){
checkbox28.checked = visible;
}
});
var checkbox29 = document.getElementById('check_layer_29');
checkbox29.addEventListener('change',function() {
var checked = this.checked;
if (checked !== lineas_de_conduccion_ene.getVisible()){
lineas_de_conduccion_ene.setVisible(checked);
}
});
lineas_de_conduccion_ene.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox29.checked){
checkbox29.checked = visible;
}
});
var checkbox30 = document.getElementById('check_layer_30');
checkbox30.addEventListener('change',function() {
var checked = this.checked;
if (checked !== muro_embalse.getVisible()){
muro_embalse.setVisible(checked);
}
});
muro_embalse.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox30.checked){
checkbox30.checked = visible;
}
});
var checkbox31 = document.getElementById('check_layer_31');
checkbox31.addEventListener('change',function() {
var checked = this.checked;
if (checked !== limite_politico_administrativo_lim.getVisible()){
limite_politico_administrativo_lim.setVisible(checked);
}
});
limite_politico_administrativo_lim.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox31.checked){
checkbox31.checked = visible;
}
});
var checkbox32 = document.getElementById('check_layer_32');
checkbox32.addEventListener('change',function() {
var checked = this.checked;
if (checked !== espejo_de_agua.getVisible()){
espejo_de_agua.setVisible(checked);
}
});
espejo_de_agua.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox32.checked){
checkbox32.checked = visible;
}
});
var checkbox33 = document.getElementById('check_layer_33');
checkbox33.addEventListener('change',function() {
var checked = this.checked;
if (checked !== ejido.getVisible()){
ejido.setVisible(checked);
}
});
ejido.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox33.checked){
checkbox33.checked = visible;
}
});
var checkbox34 = document.getElementById('check_layer_34');
checkbox34.addEventListener('change',function() {
var checked = this.checked;
if (checked !== isla.getVisible()){
isla.setVisible(checked);
}
});
isla.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox34.checked){
checkbox34.checked = visible;
}
});
var checkbox35 = document.getElementById('check_layer_35');
checkbox35.addEventListener('change',function() {
var checked = this.checked;
if (checked !== sue_congelado.getVisible()){
sue_congelado.setVisible(checked);
}
});
sue_congelado.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox35.checked){
checkbox35.checked = visible;
}
});
var checkbox36 = document.getElementById('check_layer_36');
checkbox36.addEventListener('change',function() {
var checked = this.checked;
if (checked !== sue_consolidado.getVisible()){
sue_consolidado.setVisible(checked);
}
});
sue_consolidado.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox36.checked){
checkbox36.checked = visible;
}
});
var checkbox37 = document.getElementById('check_layer_37');
checkbox37.addEventListener('change',function() {
var checked = this.checked;
if (checked !== sue_costero.getVisible()){
sue_costero.setVisible(checked);
}
});
sue_costero.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox37.checked){
checkbox37.checked = visible;
}
});
var checkbox38 = document.getElementById('check_layer_38');
checkbox38.addEventListener('change',function() {
var checked = this.checked;
if (checked !== sue_hidromorfologico.getVisible()){
sue_hidromorfologico.setVisible(checked);
}
});
sue_hidromorfologico.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox38.checked){
checkbox38.checked = visible;
}
});
var checkbox39 = document.getElementById('check_layer_39');
checkbox39.addEventListener('change',function() {
var checked = this.checked;
if (checked !== sue_no_consolidado.getVisible()){
sue_no_consolidado.setVisible(checked);
}
});
sue_no_consolidado.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox39.checked){
checkbox39.checked = visible;
}
});
var checkbox40 = document.getElementById('check_layer_40');
checkbox40.addEventListener('change',function() {
var checked = this.checked;
if (checked !== veg_arborea.getVisible()){
veg_arborea.setVisible(checked);
}
});
veg_arborea.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox40.checked){
checkbox40.checked = visible;
}
});
var checkbox41 = document.getElementById('check_layer_41');
checkbox41.addEventListener('change',function() {
var checked = this.checked;
if (checked !== veg_arbustiva.getVisible()){
veg_arbustiva.setVisible(checked);
}
});
veg_arbustiva.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox41.checked){
checkbox41.checked = visible;
}
});
var checkbox42 = document.getElementById('check_layer_42');
checkbox42.addEventListener('change',function() {
var checked = this.checked;
if (checked !== veg_cultivos.getVisible()){
veg_cultivos.setVisible(checked);
}
});
veg_cultivos.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox42.checked){
checkbox42.checked = visible;
}
});
var checkbox43 = document.getElementById('check_layer_43');
checkbox43.addEventListener('change',function() {
var checked = this.checked;
if (checked !== veg_hidrofila.getVisible()){
veg_hidrofila.setVisible(checked);
}
});
veg_hidrofila.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox43.checked){
checkbox43.checked = visible;
}
});
var checkbox44 = document.getElementById('check_layer_44');
checkbox44.addEventListener('change',function() {
var checked = this.checked;
if (checked !== veg_suelo_desnudo.getVisible()){
veg_suelo_desnudo.setVisible(checked);
}
});
veg_suelo_desnudo.on('change:visible', function(){
var visible = this.getVisible();
if (visible !== checkbox44.checked){
checkbox44.checked = visible;
}
});
/*
//Generador de codigo para las VARIABLES de los checkbox

    for (i = 0; i < NombreCapas.length; i++){
        text=       "var checkbox"+(i+1)+" = document.getElementById('check_layer_"+(i+1)+"');<br/>"+
                    "checkbox"+(i+1)+".addEventListener('change',function() {<br/>"+
                    "var checked = this.checked;<br/>"+
                    "if (checked !== "+NombreCapas[i]+".getVisible()){<br/>"+
                    NombreCapas[i]+".setVisible(checked);<br/>"+
                    "}<br/>"+
                "});<br/>"+
                NombreCapas[i]+".on('change:visible', function(){<br/>"+
                    "var visible = this.getVisible();<br/>"+
                    "if (visible !== checkbox"+(i+1)+".checked){<br/>"+
                        "checkbox"+(i+1)+".checked = visible;<br/>"+
                    "}<br/>"+
                "});"+"<br/>"
        document.write(text)        
            };
*/     

        
        
     </script>
 </body>
</html>